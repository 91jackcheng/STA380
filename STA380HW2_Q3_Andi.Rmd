---
title: "STA380HW2_Q3"
author: "Andrea You"
date: "08/18/2017"
output: html_document
mainfont: Arial
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
```{r global_options, include = FALSE}
knitr::opts_chunk$set(message=FALSE, 
tidy.opts=list(width.cutoff=60)) 
```
## R Markdown

## Question 3 Grocery (Association Rule Mining)

Overview: In this question, the main goal is to find interesting association rules for shopping baskets and the key is to pick our own thresholds for lift and confidence. Here, we define "interesting" rules as rules that could be used to take some piratical actions, especially in business settings.


We first read in the given groceries dataset and created a transactions object using the "read.transactions" function in R. The object format satisfied the format expected by the "arules" package. We then inspected and verified the first 10 items in this object. Next, we did a summary statistics on the object created and plotted the frequency of each food item. 

We first read in the given groceries dataset and did some basic exploration, then selected out rules that met minimum support and confidence thresholds.  After that, we sorted by confidence level. We approached association rules with multiple ways, all with visualization, interpretation and discussion. Finally, we offered a sample business application and several commercial suggestions.

```{r}
# Load the libraries
library(arules)
library(arulesViz)
```

```{r, warning=FALSE}
# Read in the text file as a format accessible for "arules" package
library(arules)
grocery <- read.transactions('https://raw.githubusercontent.com/jgscott/STA380/master/data/groceries.txt', sep=',')
summary(grocery)
```

```{r, warning=FALSE}
# Plot top 10 frequent appearing items in grocery
itemFrequencyPlot(grocery,topN=10)
```
###General settings
```{r, warning=FALSE}
# To get as many as rules from the start, we set the min support to 0.001 
# To get high confidence rules, we set the min confidence to 0.5
groceryrules <- apriori(grocery, parameter = list(support = 0.001, confidence = 0.5))
# Show the top 10 rules
inspect(groceryrules[1:10])
```

```{r, warning=FALSE}
# Get summary of groceryrules we have got from above
summary(groceryrules)
```
As the summary shows, there are in total 5668 rules generated. And most frequent rules appearing are 4-item ones.

```{r, warning=FALSE}
# Sort groceryrules by confidence
groceryrules<-sort(groceryrules, by="confidence")
inspect(groceryrules[1:5])
summary(groceryrules)
```

###Exploration using threholds

There are mainly three objective measures: support, confidence and lift.

```{r, warning=FALSE}
# Generally explore rules
# Choose subset according to certain lift and confidence threholds (we use their mean in this case)
inspect(subset(groceryrules,subset=lift>3.262)[1:5]) 
inspect(subset(groceryrules, subset=confidence > 0.6250)[1:5])
plot(head(subset(groceryrules,subset=lift>3.262), 20), method = "graph", control=list(cex=.8))
plot(head(subset(groceryrules, subset=confidence > 0.6250), 20), method = "graph", control=list(cex=.8))
```

Observation: 

In the case of lift is higher than its mean, there are some associations related to whole milk. Lift could be thought as how much more likely an item is to be purchased given that it is known that another item has been purchased relative to its general purchase rate. For example, with rice and sugar,it is almost four times more likely that whole milk is going to be purchased than in the general grocery purchase.


In the case of confidence is higher than its mean, there are also some associations related to whole milk.Confidence represents how likely a rule is. For example,rice,sugar associated with whole milk is a rule that has a confidence "1".


Interpretation and discussion:
In this case, it is their means that are as threholds because we targeted rules with above_than_average threholds level. 


Pontential application and suggestions:
Associations that could be used are like rice, sugar with wholemilk. Grocery stores could position these three product items closely.

However,as when lift is high, it could be the case that support is low, which means that the itemsets are rare in all grocery transactions.And rules that hold 100% of the time may not have the highest possible lift. As a result, method above has somewhat problmatic.

### Exploration with subjective selection and objective measure (contradicting or actionable)
```{r, warning=FALSE}
inspect(subset(groceryrules, subset=support > 0.01 & confidence > 0.5 & lift>3))
```

Observation: 

After trying different combinations of threholds, we chose the above one. In this case, there are associations of other vegetables with citrus fruit,root vegetables, and with root vegetables,tropical fruit. 


Interpretation and discussion:
As in this case, the corresponding association rule is actionable, we use these threholds.


Pontential application and suggestions:
Associations that could be used are like other vegetables with citrus fruit,root vegetables, and with root vegetables,tropical fruit. Grocery stores could position these these product items closely.
